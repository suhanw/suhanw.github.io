<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CZ0TSM98BL"></script><script>
									window.dataLayer = window.dataLayer || [];
									function gtag(){dataLayer.push(arguments)}
									gtag('js', new Date());
	
									gtag('config', 'G-CZ0TSM98BL');
							</script><meta charSet="utf-8"/><title>Designing a “white-label” e-commerce web app by Suhan Wijaya</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="title" content="Designing a “white-label” e-commerce web app by Suhan Wijaya"/><meta name="description" content="Streamlining development and deployment with a monorepo"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.suhanwijaya.com/posts/designing-white-label-web-app"/><meta property="og:title" content="Designing a “white-label” e-commerce web app by Suhan Wijaya"/><meta property="og:description" content="Streamlining development and deployment with a monorepo"/><meta property="og:image" content="https://www.suhanwijaya.com/images/designing-white-label-web-app-cover.jpg"/><meta name="twitter:title" content="Designing a “white-label” e-commerce web app by Suhan Wijaya"/><meta name="twitter:description" content="Streamlining development and deployment with a monorepo"/><meta name="twitter:image" content="https://www.suhanwijaya.com/images/designing-white-label-web-app-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/styles.afef422a.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.afef422a.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-5e53dfd826fb0870df0c.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.0aef9695673ee5c17c2c.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.426a09c1d54708241d15.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-e166b8248ef1c1f8ae66.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.9f7c6a36f365105412f8.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-dda0789ff9a3ec8e77f5.js" as="script"/></head><body><div id="__next"><div class="layout_GvkLX"><nav class="menu_2G6rj"><h2 class="name_10dbC">suhan <br/>wijaya</h2><ul class="menuItems_26ie3"><li class="menuItem_5m-L2"><a href="/#intro">INTRO</a></li><li class="menuItem_5m-L2"><a href="/#about">ABOUT</a></li><li class="menuItem_5m-L2"><a href="/#blog">BLOG</a></li><li class="menuItem_5m-L2"><a href="/#projects">PROJECTS</a></li><li class="menuItem_5m-L2"><a href="/#contact">CONTACT</a></li><li class="menuItem_5m-L2"><a href="/#toolbox">TOOLBOX</a></li></ul><a href="mailto:suhanw@gmail.com" target="_blank" class="email_3kN3h">suhanw@gmail.com</a><div class="social_3_hb2"><a href="https://www.linkedin.com/comm/in/suhanwijaya/" target="_blank"><img src="/images/linked-in.png" alt="Suhan&#x27;s LinkedIn profile"/></a><a href="https://x.com/suhanw" target="_blank"><img src="/images/twitter-x.png" alt="Suhan&#x27;s Twitter profile"/></a><a href="https://github.com/suhanw" target="_blank"><img src="/images/github.png" alt="Suhan&#x27;s GitHub profile"/></a></div><ul class="topMenuItems_3Vx-y"><li class="menuItem_5m-L2"><a href="/#blog">BACK TO HOME</a></li></ul></nav><button class="hamburger_1KX_H"><img src="/images/hamburger.png"/></button><article class="contentWrapper_1Wy1l"><h1 class="title_29RlI">Designing a “white-label” e-commerce web app</h1><div class="description_1Da_c">Streamlining development and deployment with a monorepo</div><div class="date_2avFh"><time dateTime="2023-06-03">Jun 3, 2023</time><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.suhanwijaya.com/posts/designing-white-label-web-app" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://x.com/intent/tweet?text=Designing a “white-label” e-commerce web app by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/designing-white-label-web-app" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-x-share.png"/></a></span></div><div class="content_33yU5"><figure>
    <img src="/images/designing-white-label-web-app-cover.jpg">
</figure>
<hr>
<p>A big challenge we had to tackle recently was to scale up our existing e-commerce web application which has been designed for a single retailer brand, to deploy multiple storefronts for various retailers that sign up for our “white label” service.</p>
<p>In addition, our solution needs to account for several requirements and constraints:</p>
<ul>
<li>avoid major rewrites and maintain code reusability</li>
<li>address internationalization and localization specific to each retailer</li>
<li>address theming and branding specific to each retailer</li>
<li>allow for various degrees of customization and extensibility of features</li>
<li>a deployment strategy that scales with the number of retailers</li>
</ul>
<hr>
<h3>Monorepo Structure</h3>
<figure>
    <img src="/images/designing-white-label-web-app-monorepo-structure.png">
</figure>
<p>A monorepo structure refers to a single repository that houses multiple applications. In our case, each retailer has its own application (<code class="language-unknown">app</code>), that consumes either retailer-specific libraries (<code class="language-unknown">lib</code>), or shared libraries that are reusable across retailers.</p>
<ol>
<li>One <code class="language-unknown">app</code> per retailer:
<ul>
<li>Each retailer has its own dedicated app within the monorepo.</li>
<li>The retailer app does not contain any components, services, or business logic. It instead configures dependency injection and wires up libs, based on retailer-specific configs.</li>
<li>Retailer-specific environment variables and configs are managed within the respective app, ensuring a tailored experience for each retailer.</li>
</ul>
</li>
<li>One retailer-specific <code class="language-unknown">lib</code> per retailer:
<ul>
<li>Code that is unique to each retailer lives in this <code class="language-unknown">lib</code>, comprising approximately 10-20% of the overall code.</li>
<li>Examples of retailer-specific code include internationalization/localization content, branding color schemes and typography, and any business logic particular to the retailer.</li>
<li>These retailer-specific libraries must adhere to a common interface, enabling easy integration into shared libraries and components.</li>
</ul>
</li>
<li>Multiple shared <code class="language-unknown">lib</code>s reusable across retailers:
<ul>
<li>Shared libraries constitute the majority of the codebase, accounting for approximately 80-90% of the overall code.</li>
<li>These shared libraries contain reusable code that can be utilized by all retailers, ensuring consistency and promoting code reusability.</li>
<li>By default, new features are implemented within shared libraries to enable seamless inheritance across retailers.</li>
</ul>
</li>
</ol>
<hr>
<h3>Broad Strategy</h3>
<figure>
    <img src="https://media.tenor.com/HnurQKt7zSQAAAAC/jim-carrey-jim-carrey-typing.gif">
</figure>
<p>To efficiently manage code within the monorepo structure, here’s the general strategy that governs where features are implemented and how the code is organized.</p>
<ol>
<li>Shared libraries for common features:
<ul>
<li>Unless explicitly specified, new features are implemented within shared libraries, allowing all retailers, including future retailers, to inherit these features by default.</li>
<li>This approach ensures consistency across all retailers and simplifies maintaining feature parity.</li>
</ul>
</li>
<li>Retailer-specific libraries for unique features:
<ul>
<li>If there is a clear distinction in business logic between retailers, or a feature is particular to a retailer, it is implemented within retailer-specific libraries.</li>
<li>Retailer-specific libraries follow the same interface requirements, enabling seamless integration with shared libraries and components.</li>
<li>For instance, each retailer must have a <code class="language-unknown">Logo</code> component. The shared <code class="language-unknown">TopNav</code> component imports the appropriate <code class="language-unknown">Logo</code> component based on the compile configurations defined in the retailer app.</li>
</ul>
</li>
<li>Flexibility in code organization:
<ul>
<li>Depending on the complexity of retailer-specific logic, code organization within retailer-specific libraries can be high-level or low-level.</li>
<li>For example, we can create a distinct <code class="language-unknown">TopNav</code> component for each retailer to display a retailer-specific logo.</li>
<li>Alternatively, all retailers can use a shared <code class="language-unknown">TopNav</code> component that has common UI features, while importing a retailer-specific <code class="language-unknown">Logo</code> component.</li>
</ul>
</li>
</ol>
<hr>
<h3>Deployment Mechanism</h3>
<figure>
    <img src="/images/designing-white-label-web-app-deploy-chart.png">
</figure>
<p>Efficient deployment is crucial to propagate updates correctly across retailers and to avoid unnecessary deployments. The logic is essentially this:</p>
<ol>
<li>Perform code change analysis between the most recent commit and the last commit that triggered a successful production deployment.</li>
<li>If updates were made only to retailer-specific code, only deploy that particular retailer storefront.</li>
<li>If updates were made to code that’s shared across all or some retailers, only deploy the retailer storefronts with changed dependencies.</li>
<li>Rinse and repeat.</li>
</ol>
<p>Thanks for reading. I may dive into the code in a future(ish 😅) article.</p>
</div><div class="footer_2PjJq"><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.suhanwijaya.com/posts/designing-white-label-web-app" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://x.com/intent/tweet?text=Designing a “white-label” e-commerce web app by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/designing-white-label-web-app" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-x-share.png"/></a></span></div><div class="author_3TJVZ"><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya"><img src="https://github.com/suhanw.png?size=200"/></a><span>Liked what you&#x27;ve read? <br/><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya">Follow me on LinkedIn!</a></span></div></article><nav class="bottomMenu_SThI5 mobileOnly_bZ-pA"><div class="authorMobile_IHm92"><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya"><img src="https://github.com/suhanw.png?size=200"/></a><span>Liked what you&#x27;ve read? <br/><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya">Follow me on LinkedIn!</a></span></div></nav></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"designing-white-label-web-app","contentHtml":"\u003cfigure\u003e\n    \u003cimg src=\"/images/designing-white-label-web-app-cover.jpg\"\u003e\n\u003c/figure\u003e\n\u003chr\u003e\n\u003cp\u003eA big challenge we had to tackle recently was to scale up our existing e-commerce web application which has been designed for a single retailer brand, to deploy multiple storefronts for various retailers that sign up for our “white label” service.\u003c/p\u003e\n\u003cp\u003eIn addition, our solution needs to account for several requirements and constraints:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eavoid major rewrites and maintain code reusability\u003c/li\u003e\n\u003cli\u003eaddress internationalization and localization specific to each retailer\u003c/li\u003e\n\u003cli\u003eaddress theming and branding specific to each retailer\u003c/li\u003e\n\u003cli\u003eallow for various degrees of customization and extensibility of features\u003c/li\u003e\n\u003cli\u003ea deployment strategy that scales with the number of retailers\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003eMonorepo Structure\u003c/h3\u003e\n\u003cfigure\u003e\n    \u003cimg src=\"/images/designing-white-label-web-app-monorepo-structure.png\"\u003e\n\u003c/figure\u003e\n\u003cp\u003eA monorepo structure refers to a single repository that houses multiple applications. In our case, each retailer has its own application (\u003ccode class=\"language-unknown\"\u003eapp\u003c/code\u003e), that consumes either retailer-specific libraries (\u003ccode class=\"language-unknown\"\u003elib\u003c/code\u003e), or shared libraries that are reusable across retailers.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eOne \u003ccode class=\"language-unknown\"\u003eapp\u003c/code\u003e per retailer:\n\u003cul\u003e\n\u003cli\u003eEach retailer has its own dedicated app within the monorepo.\u003c/li\u003e\n\u003cli\u003eThe retailer app does not contain any components, services, or business logic. It instead configures dependency injection and wires up libs, based on retailer-specific configs.\u003c/li\u003e\n\u003cli\u003eRetailer-specific environment variables and configs are managed within the respective app, ensuring a tailored experience for each retailer.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eOne retailer-specific \u003ccode class=\"language-unknown\"\u003elib\u003c/code\u003e per retailer:\n\u003cul\u003e\n\u003cli\u003eCode that is unique to each retailer lives in this \u003ccode class=\"language-unknown\"\u003elib\u003c/code\u003e, comprising approximately 10-20% of the overall code.\u003c/li\u003e\n\u003cli\u003eExamples of retailer-specific code include internationalization/localization content, branding color schemes and typography, and any business logic particular to the retailer.\u003c/li\u003e\n\u003cli\u003eThese retailer-specific libraries must adhere to a common interface, enabling easy integration into shared libraries and components.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMultiple shared \u003ccode class=\"language-unknown\"\u003elib\u003c/code\u003es reusable across retailers:\n\u003cul\u003e\n\u003cli\u003eShared libraries constitute the majority of the codebase, accounting for approximately 80-90% of the overall code.\u003c/li\u003e\n\u003cli\u003eThese shared libraries contain reusable code that can be utilized by all retailers, ensuring consistency and promoting code reusability.\u003c/li\u003e\n\u003cli\u003eBy default, new features are implemented within shared libraries to enable seamless inheritance across retailers.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3\u003eBroad Strategy\u003c/h3\u003e\n\u003cfigure\u003e\n    \u003cimg src=\"https://media.tenor.com/HnurQKt7zSQAAAAC/jim-carrey-jim-carrey-typing.gif\"\u003e\n\u003c/figure\u003e\n\u003cp\u003eTo efficiently manage code within the monorepo structure, here’s the general strategy that governs where features are implemented and how the code is organized.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eShared libraries for common features:\n\u003cul\u003e\n\u003cli\u003eUnless explicitly specified, new features are implemented within shared libraries, allowing all retailers, including future retailers, to inherit these features by default.\u003c/li\u003e\n\u003cli\u003eThis approach ensures consistency across all retailers and simplifies maintaining feature parity.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eRetailer-specific libraries for unique features:\n\u003cul\u003e\n\u003cli\u003eIf there is a clear distinction in business logic between retailers, or a feature is particular to a retailer, it is implemented within retailer-specific libraries.\u003c/li\u003e\n\u003cli\u003eRetailer-specific libraries follow the same interface requirements, enabling seamless integration with shared libraries and components.\u003c/li\u003e\n\u003cli\u003eFor instance, each retailer must have a \u003ccode class=\"language-unknown\"\u003eLogo\u003c/code\u003e component. The shared \u003ccode class=\"language-unknown\"\u003eTopNav\u003c/code\u003e component imports the appropriate \u003ccode class=\"language-unknown\"\u003eLogo\u003c/code\u003e component based on the compile configurations defined in the retailer app.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eFlexibility in code organization:\n\u003cul\u003e\n\u003cli\u003eDepending on the complexity of retailer-specific logic, code organization within retailer-specific libraries can be high-level or low-level.\u003c/li\u003e\n\u003cli\u003eFor example, we can create a distinct \u003ccode class=\"language-unknown\"\u003eTopNav\u003c/code\u003e component for each retailer to display a retailer-specific logo.\u003c/li\u003e\n\u003cli\u003eAlternatively, all retailers can use a shared \u003ccode class=\"language-unknown\"\u003eTopNav\u003c/code\u003e component that has common UI features, while importing a retailer-specific \u003ccode class=\"language-unknown\"\u003eLogo\u003c/code\u003e component.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3\u003eDeployment Mechanism\u003c/h3\u003e\n\u003cfigure\u003e\n    \u003cimg src=\"/images/designing-white-label-web-app-deploy-chart.png\"\u003e\n\u003c/figure\u003e\n\u003cp\u003eEfficient deployment is crucial to propagate updates correctly across retailers and to avoid unnecessary deployments. The logic is essentially this:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ePerform code change analysis between the most recent commit and the last commit that triggered a successful production deployment.\u003c/li\u003e\n\u003cli\u003eIf updates were made only to retailer-specific code, only deploy that particular retailer storefront.\u003c/li\u003e\n\u003cli\u003eIf updates were made to code that’s shared across all or some retailers, only deploy the retailer storefronts with changed dependencies.\u003c/li\u003e\n\u003cli\u003eRinse and repeat.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThanks for reading. I may dive into the code in a future(ish 😅) article.\u003c/p\u003e\n","pin_order":9,"title":"Designing a “white-label” e-commerce web app","description":"Streamlining development and deployment with a monorepo","image":"https://www.suhanwijaya.com/images/designing-white-label-web-app-cover.jpg","tags":"javascript,webdev,monorepo,ecommerce","date":"2023-06-03"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"designing-white-label-web-app"},"buildId":"9EjHFCoMdL6HDY6LmFUZ-","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-04ff97a05ed484bd5f0e.js"></script><script src="/_next/static/chunks/main-5e53dfd826fb0870df0c.js" async=""></script><script src="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.0aef9695673ee5c17c2c.js" async=""></script><script src="/_next/static/chunks/styles.426a09c1d54708241d15.js" async=""></script><script src="/_next/static/chunks/pages/_app-e166b8248ef1c1f8ae66.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.9f7c6a36f365105412f8.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-dda0789ff9a3ec8e77f5.js" async=""></script><script src="/_next/static/9EjHFCoMdL6HDY6LmFUZ-/_buildManifest.js" async=""></script><script src="/_next/static/9EjHFCoMdL6HDY6LmFUZ-/_ssgManifest.js" async=""></script></body></html>