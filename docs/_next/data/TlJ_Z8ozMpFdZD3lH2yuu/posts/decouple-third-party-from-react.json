{"pageProps":{"postData":{"id":"decouple-third-party-from-react","contentHtml":"<figure>\n\t<img src=\"https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG\">\n\t<figcaption>KNOW YOUR ENEMY<br /> (image by <a href=\"https://unsplash.com/photos/CatcixzdUcg\">Klara Kulikova</a>, meme from <a href=\"https://programming-memes.com/spaghetti-code-know-your-enemy/\">Programming Memes</a>)</figcaption>\n</figure>\n<hr>\n<p>Suppose I use a third party service provider to process payments for my E-commerce app, and I need to embed some third party code to integrate the payment service into my app.</p>\n<p>In this oversimplified example, let‚Äôs say the payment service is responsible for checking whether a given payment method (e.g, Apple Pay and Google Pay) is available based on the customer‚Äôs device, region, etc. While my ‚Äúcore‚Äù UI component <code class=\"language-unknown\">PaymentOptions</code> is responsible for rendering the available payment methods as options. Lastly, I want the flexibility of adding new payment methods in the future (for üìàüí∞reasons).</p>\n<p>I can write it this way.</p>\n<script src=\"https://gist.github.com/suhanw/1cb50a75844ae43cc3ff9b24d8ffefb7.js\"></script>\n<p>However, the UI code is tightly coupled with the third party code from the payment service, i.e., <strong>I have to modify the</strong>  <strong><code class=\"language-unknown\">PaymentOptions</code> component in order to add a new payment method or to make third party code updates.</strong></p>\n<hr>\n<p>I can perhaps break out the third party code into a separate hook.</p>\n<script src=\"https://gist.github.com/suhanw/05b0dabbd467a37ec410c8efc6b6f94f.js\"></script>\n<p><strong>However, I <em>still</em> have to modify</strong>  <strong><code class=\"language-unknown\">PaymentOptions</code></strong>  <strong>and any other components that share the</strong>  <strong><code class=\"language-unknown\">usePaymentMethods</code> hook if I wanted to add, for example,</strong>  <strong><code class=\"language-unknown\">isPaypalAvailable</code>.</strong></p>\n<hr>\n<p>To minimize the size of future PRs, I‚Äôve been thinking about the Open/Closed Principle, the ‚ÄúO‚Äù in SOLID (check out this excellent <a href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\">explainer</a>): ‚Äú<em>A software artifact should be open for extension but closed for modification.‚Äù</em></p>\n<p>In my own words: <em>I should design this feature in such a way that I don‚Äôt have to touch any of the original code I wrote (closed for modification) if I were to add new payment methods in the future (open for extension).</em></p>\n<p>Here‚Äôs my take on this principle. Let‚Äôs separate the payment service into its own module: a simple object where each key represents a payment method. Every payment method key points to an object with an <code class=\"language-unknown\">isAvailable</code> property (a function that uses the third party code) and a <code class=\"language-unknown\">component</code> property (the UI component for the payment option).</p>\n<script src=\"https://gist.github.com/suhanw/7a3365d6e85f1d236fca12fcc4bba348.js\"></script>\n<p>Import <code class=\"language-unknown\">paymentServiceModule</code> into the <code class=\"language-unknown\">PaymentOptions</code> component.</p>\n<script src=\"https://gist.github.com/suhanw/b24d91ae215e6b4ba839a0f9bf9ba462.js\"></script>\n<p><code class=\"language-unknown\">PaymentOptions</code> is now decoupled from the third party implementation details, and is ignorant of the particular payment methods.</p>\n<p>When I want to extend this feature with a new payment method (i.e., PayPal), <strong>I simply slot in a new key/value pair to <code class=\"language-unknown\">paymentServiceModule</code> without having to modify either the <code class=\"language-unknown\">PaymentOptions</code> component or the original payment methods</strong>.</p>\n<script src=\"https://gist.github.com/suhanw/1b7d7ac0a6faf4838a169be094cba14a.js\"></script>\n<p>The UI code should in theory also be protected against modification if I were to change payment service providers (for üí∏ reasons) as long as the payment method‚Äôs duck typing remains unchanged.</p>\n<p>Am I applying the Open/Closed Principle correctly? Curious to learn other React or JavaScript patterns in the wild that follow this principle.</p>\n<hr>\n<h3>Bonus</h3>\n<p>In <code class=\"language-unknown\">paymentServiceModule</code>, lazy load each payment option using the <a href=\"https://reactjs.org/docs/code-splitting.html#reactlazy\"><code class=\"language-unknown\">React.lazy</code></a> API.</p>\n<script src=\"https://gist.github.com/suhanw/3b3055a9ad84e5bc1b12d423fc2bad6b.js\"></script> \n<p>In <code class=\"language-unknown\">PaymentOptions</code>, wrap each payment option in <code class=\"language-unknown\">Suspense</code>, to lazy load the component based on availability.</p>\n<script src=\"https://gist.github.com/suhanw/3f68acc8c449c430a83109ede199a44f.js\"></script>\n<hr>\n<h3>Resources</h3>\n<ul>\n<li><a href=\"https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863\">A First Step to Improve Your Code Before Diving into Domain Driven Design or the Clean Architecture</a> by <a href=\"https://medium.com/u/57de27e2974f\">Andr√©as Hanss</a></li>\n<li><a href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\">Revisiting SOLID</a> by <a href=\"https://medium.com/u/12cc371abade\">Matthew Lucas</a></li>\n</ul>\n<hr>\n<h3>Read More</h3>\n<ul>\n<li><a href=\"https://www.suhanwijaya.com/posts/intro-to-react-server-side-rendering\">Intro to React Server Side Rendering</a></li>\n<li><a href=\"https://www.suhanwijaya.com/posts/decouple-data-from-ui-with-react-hooks\">Decouple Data from UI with React Hooks</a></li>\n<li><a href=\"https://www.suhanwijaya.com/posts/decouple-data-from-ui-in-react\">Decouple Data from UI in React Part 2: Hooks, Render Props, and HOC patterns</a></li>\n</ul>\n","pin_order":6,"title":"Decouple Third Party Code From Core React Code","description":"And reduce the size of your future PRs with the Open/Closed Principle","image":"https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG","tags":"softwaredesign,react,webdev,javascript","canonical_url":"https://medium.com/javascript-in-plain-english/decouple-external-services-from-your-core-ui-code-dd490f91ae49","author":"Suhan Wijaya","date":"2020-11-30"}},"__N_SSG":true}