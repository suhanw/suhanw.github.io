<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CZ0TSM98BL"></script><script>
							window.dataLayer = window.dataLayer || [];
							function gtag(){dataLayer.push(arguments)}
							gtag('js', new Date());

							gtag('config', 'G-CZ0TSM98BL');
					</script><meta charSet="utf-8"/><title>Decouple Third Party Code From Core React Code by Suhan Wijaya</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="title" content="Decouple Third Party Code From Core React Code by Suhan Wijaya"/><meta name="description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.suhanwijaya.com/posts/decouple-third-party-from-react"/><meta property="og:title" content="Decouple Third Party Code From Core React Code by Suhan Wijaya"/><meta property="og:description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta property="og:image" content="https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG"/><meta name="twitter:title" content="Decouple Third Party Code From Core React Code by Suhan Wijaya"/><meta name="twitter:description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta name="twitter:image" content="https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG"/><meta name="twitter:card" content="summary_large_image"/><link rel="canonical" href="https://medium.com/javascript-in-plain-english/decouple-external-services-from-your-core-ui-code-dd490f91ae49"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/styles.29ba8f88.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.29ba8f88.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-08372472a9a690b518ed.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.d4f57090bd55662b89aa.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.2fb92792e98ddc01317c.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3f426cc9284b0d3f87e0.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.80435513b29873052229.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-1bfe5aaa25fb13bc683c.js" as="script"/></head><body><div id="__next"><div class="layout_GvkLX hasTopMenu_1WVP3"><nav class="menu_2G6rj topMenu_3pGJ_"><h2 class="name_10dbC">suhan <br/>wijaya</h2><ul class="menuItems_26ie3"><li class="menuItem_5m-L2"><a href="/#intro">INTRO</a></li><li class="menuItem_5m-L2"><a href="/#about">ABOUT</a></li><li class="menuItem_5m-L2"><a href="/#blog">BLOG</a></li><li class="menuItem_5m-L2"><a href="/#projects">PROJECTS</a></li><li class="menuItem_5m-L2"><a href="/#contact">CONTACT</a></li><li class="menuItem_5m-L2"><a href="/#toolbox">TOOLBOX</a></li></ul><a href="mailto:suhanw@gmail.com" target="_blank" class="email_3kN3h">suhanw@gmail.com</a><div class="social_3_hb2"><a href="https://www.linkedin.com/in/suhanwijaya/" target="_blank"><img src="/images/linked-in.png" alt="Suhan&#x27;s LinkedIn profile"/></a><a href="https://twitter.com/suhanw" target="_blank"><img src="/images/twitter.png" alt="Suhan&#x27;s Twitter profile"/></a><a href="https://github.com/suhanw" target="_blank"><img src="/images/github.png" alt="Suhan&#x27;s GitHub profile"/></a></div><ul class="topMenuItems_3Vx-y"><li class="menuItem_5m-L2"><a href="/#blog">BACK TO HOME</a></li></ul></nav><button class="hamburger_1KX_H"><img src="/images/hamburger.png"/></button><article class="contentWrapper_1Wy1l"><h1 class="title_29RlI">Decouple Third Party Code From Core React Code</h1><div class="description_1Da_c">And reduce the size of your future PRs with the Open/Closed Principle</div><div class="date_2avFh"><time dateTime="2020-11-30">Nov 30, 2020</time><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.suhanwijaya.com/posts/decouple-third-party-from-react" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://twitter.com/intent/tweet?text=Decouple Third Party Code From Core React Code by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/decouple-third-party-from-react" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-share.png"/></a></span></div><div class="content_33yU5"><figure>
	<img src="https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG">
	<figcaption>KNOW YOUR ENEMY<br /> (image by <a href="https://unsplash.com/photos/CatcixzdUcg">Klara Kulikova</a>, meme from <a href="https://programming-memes.com/spaghetti-code-know-your-enemy/">Programming Memes</a>)</figcaption>
</figure>
<hr>
<p>Suppose I use a third party service provider to process payments for my E-commerce app, and I need to embed some third party code to integrate the payment service into my app.</p>
<p>In this oversimplified example, let‚Äôs say the payment service is responsible for checking whether a given payment method (e.g, Apple Pay and Google Pay) is available based on the customer‚Äôs device, region, etc. While my ‚Äúcore‚Äù UI component <code class="language-unknown">PaymentOptions</code> is responsible for rendering the available payment methods as options. Lastly, I want the flexibility of adding new payment methods in the future (for üìàüí∞reasons).</p>
<p>I can write it this way.</p>
<script src="https://gist.github.com/suhanw/1cb50a75844ae43cc3ff9b24d8ffefb7.js"></script>
<p>However, the UI code is tightly coupled with the third party code from the payment service, i.e., <strong>I have to modify the</strong>  <strong><code class="language-unknown">PaymentOptions</code> component in order to add a new payment method or to make third party code updates.</strong></p>
<hr>
<p>I can perhaps break out the third party code into a separate hook.</p>
<script src="https://gist.github.com/suhanw/05b0dabbd467a37ec410c8efc6b6f94f.js"></script>
<p><strong>However, I <em>still</em> have to modify</strong>  <strong><code class="language-unknown">PaymentOptions</code></strong>  <strong>and any other components that share the</strong>  <strong><code class="language-unknown">usePaymentMethods</code> hook if I wanted to add, for example,</strong>  <strong><code class="language-unknown">isPaypalAvailable</code>.</strong></p>
<hr>
<p>To minimize the size of future PRs, I‚Äôve been thinking about the Open/Closed Principle, the ‚ÄúO‚Äù in SOLID (check out this excellent <a href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3">explainer</a>): ‚Äú<em>A software artifact should be open for extension but closed for modification.‚Äù</em></p>
<p>In my own words: <em>I should design this feature in such a way that I don‚Äôt have to touch any of the original code I wrote (closed for modification) if I were to add new payment methods in the future (open for extension).</em></p>
<p>Here‚Äôs my take on this principle. Let‚Äôs separate the payment service into its own module: a simple object where each key represents a payment method. Every payment method key points to an object with an <code class="language-unknown">isAvailable</code> property (a function that uses the third party code) and a <code class="language-unknown">component</code> property (the UI component for the payment option).</p>
<script src="https://gist.github.com/suhanw/7a3365d6e85f1d236fca12fcc4bba348.js"></script>
<p>Import <code class="language-unknown">paymentServiceModule</code> into the <code class="language-unknown">PaymentOptions</code> component.</p>
<script src="https://gist.github.com/suhanw/b24d91ae215e6b4ba839a0f9bf9ba462.js"></script>
<p><code class="language-unknown">PaymentOptions</code> is now decoupled from the third party implementation details, and is ignorant of the particular payment methods.</p>
<p>When I want to extend this feature with a new payment method (i.e., PayPal), <strong>I simply slot in a new key/value pair to <code class="language-unknown">paymentServiceModule</code> without having to modify either the <code class="language-unknown">PaymentOptions</code> component or the original payment methods</strong>.</p>
<script src="https://gist.github.com/suhanw/1b7d7ac0a6faf4838a169be094cba14a.js"></script>
<p>The UI code should in theory also be protected against modification if I were to change payment service providers (for üí∏ reasons) as long as the payment method‚Äôs duck typing remains unchanged.</p>
<p>Am I applying the Open/Closed Principle correctly? Curious to learn other React or JavaScript patterns in the wild that follow this principle.</p>
<hr>
<h3>Bonus</h3>
<p>In <code class="language-unknown">paymentServiceModule</code>, lazy load each payment option using the <a href="https://reactjs.org/docs/code-splitting.html#reactlazy"><code class="language-unknown">React.lazy</code></a> API.</p>
<script src="https://gist.github.com/suhanw/3b3055a9ad84e5bc1b12d423fc2bad6b.js"></script> 
<p>In <code class="language-unknown">PaymentOptions</code>, wrap each payment option in <code class="language-unknown">Suspense</code>, to lazy load the component based on availability.</p>
<script src="https://gist.github.com/suhanw/3f68acc8c449c430a83109ede199a44f.js"></script>
<hr>
<h3>Resources</h3>
<ul>
<li><a href="https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863">A First Step to Improve Your Code Before Diving into Domain Driven Design or the Clean Architecture</a> by <a href="https://medium.com/u/57de27e2974f">Andr√©as Hanss</a></li>
<li><a href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3">Revisiting SOLID</a> by <a href="https://medium.com/u/12cc371abade">Matthew Lucas</a></li>
</ul>
<hr>
<h3>Read More</h3>
<ul>
<li><a href="https://www.suhanwijaya.com/posts/intro-to-react-server-side-rendering">Intro to React Server Side Rendering</a></li>
<li><a href="https://www.suhanwijaya.com/posts/decouple-data-from-ui-with-react-hooks">Decouple Data from UI with React Hooks</a></li>
<li><a href="https://www.suhanwijaya.com/posts/decouple-data-from-ui-in-react">Decouple Data from UI in React Part 2: Hooks, Render Props, and HOC patterns</a></li>
</ul>
<hr>
<p>üì´ <em>Let‚Äôs connect on</em> <a href="https://www.linkedin.com/in/suhanwijaya/"><em>LinkedIn</em></a> <em>or <em><a href="https://twitter.com/suhanw"><em>Twitter</em></a></em>!</em></p>
</div><div class="footer_2PjJq"><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.suhanwijaya.com/posts/decouple-third-party-from-react" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://twitter.com/intent/tweet?text=Decouple Third Party Code From Core React Code by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/decouple-third-party-from-react" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-share.png"/></a></span></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"decouple-third-party-from-react","contentHtml":"\u003cfigure\u003e\n\t\u003cimg src=\"https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG\"\u003e\n\t\u003cfigcaption\u003eKNOW YOUR ENEMY\u003cbr /\u003e (image by \u003ca href=\"https://unsplash.com/photos/CatcixzdUcg\"\u003eKlara Kulikova\u003c/a\u003e, meme from \u003ca href=\"https://programming-memes.com/spaghetti-code-know-your-enemy/\"\u003eProgramming Memes\u003c/a\u003e)\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003chr\u003e\n\u003cp\u003eSuppose I use a third party service provider to process payments for my E-commerce app, and I need to embed some third party code to integrate the payment service into my app.\u003c/p\u003e\n\u003cp\u003eIn this oversimplified example, let‚Äôs say the payment service is responsible for checking whether a given payment method (e.g, Apple Pay and Google Pay) is available based on the customer‚Äôs device, region, etc. While my ‚Äúcore‚Äù UI component \u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e is responsible for rendering the available payment methods as options. Lastly, I want the flexibility of adding new payment methods in the future (for üìàüí∞reasons).\u003c/p\u003e\n\u003cp\u003eI can write it this way.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/1cb50a75844ae43cc3ff9b24d8ffefb7.js\"\u003e\u003c/script\u003e\n\u003cp\u003eHowever, the UI code is tightly coupled with the third party code from the payment service, i.e., \u003cstrong\u003eI have to modify the\u003c/strong\u003e  \u003cstrong\u003e\u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e component in order to add a new payment method or to make third party code updates.\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eI can perhaps break out the third party code into a separate hook.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/05b0dabbd467a37ec410c8efc6b6f94f.js\"\u003e\u003c/script\u003e\n\u003cp\u003e\u003cstrong\u003eHowever, I \u003cem\u003estill\u003c/em\u003e have to modify\u003c/strong\u003e  \u003cstrong\u003e\u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e\u003c/strong\u003e  \u003cstrong\u003eand any other components that share the\u003c/strong\u003e  \u003cstrong\u003e\u003ccode class=\"language-unknown\"\u003eusePaymentMethods\u003c/code\u003e hook if I wanted to add, for example,\u003c/strong\u003e  \u003cstrong\u003e\u003ccode class=\"language-unknown\"\u003eisPaypalAvailable\u003c/code\u003e.\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eTo minimize the size of future PRs, I‚Äôve been thinking about the Open/Closed Principle, the ‚ÄúO‚Äù in SOLID (check out this excellent \u003ca href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\"\u003eexplainer\u003c/a\u003e): ‚Äú\u003cem\u003eA software artifact should be open for extension but closed for modification.‚Äù\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eIn my own words: \u003cem\u003eI should design this feature in such a way that I don‚Äôt have to touch any of the original code I wrote (closed for modification) if I were to add new payment methods in the future (open for extension).\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eHere‚Äôs my take on this principle. Let‚Äôs separate the payment service into its own module: a simple object where each key represents a payment method. Every payment method key points to an object with an \u003ccode class=\"language-unknown\"\u003eisAvailable\u003c/code\u003e property (a function that uses the third party code) and a \u003ccode class=\"language-unknown\"\u003ecomponent\u003c/code\u003e property (the UI component for the payment option).\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/7a3365d6e85f1d236fca12fcc4bba348.js\"\u003e\u003c/script\u003e\n\u003cp\u003eImport \u003ccode class=\"language-unknown\"\u003epaymentServiceModule\u003c/code\u003e into the \u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e component.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/b24d91ae215e6b4ba839a0f9bf9ba462.js\"\u003e\u003c/script\u003e\n\u003cp\u003e\u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e is now decoupled from the third party implementation details, and is ignorant of the particular payment methods.\u003c/p\u003e\n\u003cp\u003eWhen I want to extend this feature with a new payment method (i.e., PayPal), \u003cstrong\u003eI simply slot in a new key/value pair to \u003ccode class=\"language-unknown\"\u003epaymentServiceModule\u003c/code\u003e without having to modify either the \u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e component or the original payment methods\u003c/strong\u003e.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/1b7d7ac0a6faf4838a169be094cba14a.js\"\u003e\u003c/script\u003e\n\u003cp\u003eThe UI code should in theory also be protected against modification if I were to change payment service providers (for üí∏ reasons) as long as the payment method‚Äôs duck typing remains unchanged.\u003c/p\u003e\n\u003cp\u003eAm I applying the Open/Closed Principle correctly? Curious to learn other React or JavaScript patterns in the wild that follow this principle.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eBonus\u003c/h3\u003e\n\u003cp\u003eIn \u003ccode class=\"language-unknown\"\u003epaymentServiceModule\u003c/code\u003e, lazy load each payment option using the \u003ca href=\"https://reactjs.org/docs/code-splitting.html#reactlazy\"\u003e\u003ccode class=\"language-unknown\"\u003eReact.lazy\u003c/code\u003e\u003c/a\u003e API.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/3b3055a9ad84e5bc1b12d423fc2bad6b.js\"\u003e\u003c/script\u003e \n\u003cp\u003eIn \u003ccode class=\"language-unknown\"\u003ePaymentOptions\u003c/code\u003e, wrap each payment option in \u003ccode class=\"language-unknown\"\u003eSuspense\u003c/code\u003e, to lazy load the component based on availability.\u003c/p\u003e\n\u003cscript src=\"https://gist.github.com/suhanw/3f68acc8c449c430a83109ede199a44f.js\"\u003e\u003c/script\u003e\n\u003chr\u003e\n\u003ch3\u003eResources\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863\"\u003eA First Step to Improve Your Code Before Diving into Domain Driven Design or the Clean Architecture\u003c/a\u003e by \u003ca href=\"https://medium.com/u/57de27e2974f\"\u003eAndr√©as Hanss\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\"\u003eRevisiting SOLID\u003c/a\u003e by \u003ca href=\"https://medium.com/u/12cc371abade\"\u003eMatthew Lucas\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003eRead More\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.suhanwijaya.com/posts/intro-to-react-server-side-rendering\"\u003eIntro to React Server Side Rendering\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.suhanwijaya.com/posts/decouple-data-from-ui-with-react-hooks\"\u003eDecouple Data from UI with React Hooks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.suhanwijaya.com/posts/decouple-data-from-ui-in-react\"\u003eDecouple Data from UI in React Part 2: Hooks, Render Props, and HOC patterns\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003eüì´ \u003cem\u003eLet‚Äôs connect on\u003c/em\u003e \u003ca href=\"https://www.linkedin.com/in/suhanwijaya/\"\u003e\u003cem\u003eLinkedIn\u003c/em\u003e\u003c/a\u003e \u003cem\u003eor \u003cem\u003e\u003ca href=\"https://twitter.com/suhanw\"\u003e\u003cem\u003eTwitter\u003c/em\u003e\u003c/a\u003e\u003c/em\u003e!\u003c/em\u003e\u003c/p\u003e\n","pin_order":6,"title":"Decouple Third Party Code From Core React Code","description":"And reduce the size of your future PRs with the Open/Closed Principle","image":"https://www.suhanwijaya.com/images/decouple-third-party-from-react-cover.JPG","tags":"softwaredesign,react,webdev,javascript","canonical_url":"https://medium.com/javascript-in-plain-english/decouple-external-services-from-your-core-ui-code-dd490f91ae49","author":"Suhan Wijaya","date":"2020-11-30"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"decouple-third-party-from-react"},"buildId":"qrlzQRrDCdRVIuXCd6WIu","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-28a453ab78bd7ac4fdb9.js"></script><script src="/_next/static/chunks/main-08372472a9a690b518ed.js" async=""></script><script src="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.d4f57090bd55662b89aa.js" async=""></script><script src="/_next/static/chunks/styles.2fb92792e98ddc01317c.js" async=""></script><script src="/_next/static/chunks/pages/_app-3f426cc9284b0d3f87e0.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.80435513b29873052229.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-1bfe5aaa25fb13bc683c.js" async=""></script><script src="/_next/static/qrlzQRrDCdRVIuXCd6WIu/_buildManifest.js" async=""></script><script src="/_next/static/qrlzQRrDCdRVIuXCd6WIu/_ssgManifest.js" async=""></script></body></html>