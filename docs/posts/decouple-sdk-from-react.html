<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Decouple SDK Code From Core React Code by Suhan Wijaya</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="title" content="Decouple SDK Code From Core React Code by Suhan Wijaya"/><meta name="description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.suhanwijaya.com/posts/decouple-sdk-from-react"/><meta property="og:title" content="Decouple SDK Code From Core React Code by Suhan Wijaya"/><meta property="og:description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta property="og:image"/><meta name="twitter:title" content="Decouple SDK Code From Core React Code by Suhan Wijaya"/><meta name="twitter:description" content="And reduce the size of your future PRs with the Open/Closed Principle"/><meta name="twitter:image"/><meta name="twitter:card" content="summary_large_image"/><link rel="canonical" href="https://medium.com/javascript-in-plain-english/decouple-external-services-from-your-core-ui-code-dd490f91ae49"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/styles.f65c7002.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.f65c7002.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-08372472a9a690b518ed.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/e4c8223e6318a62675b83f1688c61c375db5b2bb.d4f57090bd55662b89aa.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.718046618e39c9df9f0b.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3f426cc9284b0d3f87e0.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.4aea04fc80fc95b214df.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-1cc17da55ef19e625b6d.js" as="script"/></head><body><div id="__next"><div class="layout_GvkLX hasTopMenu_1WVP3"><nav class="menu_2G6rj topMenu_3pGJ_"><h2 class="name_10dbC">suhan <br/>wijaya</h2><ul class="menuItems_26ie3"><li class="menuItem_5m-L2"><a href="/#intro">INTRO</a></li><li class="menuItem_5m-L2"><a href="/#about">ABOUT</a></li><li class="menuItem_5m-L2"><a href="/#blog">BLOG</a></li><li class="menuItem_5m-L2"><a href="/#projects">PROJECTS</a></li><li class="menuItem_5m-L2"><a href="/#contact">CONTACT</a></li><li class="menuItem_5m-L2"><a href="/#technologies">TECHNOLOGIES</a></li></ul><a href="mailto:suhanw@gmail.com" target="_blank" class="email_3kN3h">suhanw@gmail.com</a><div class="social_3_hb2"><a href="https://www.linkedin.com/in/suhanwijaya/" target="_blank"><img src="/images/linked-in.png"/></a><a href="https://twitter.com/suhanw" target="_blank"><img src="/images/twitter.png"/></a><a href="https://github.com/suhanw" target="_blank"><img src="/images/github.png"/></a></div><ul class="topMenuItems_3Vx-y"><li class="menuItem_5m-L2"><a href="/#blog">BACK TO HOME</a></li></ul></nav><button class="hamburger_1KX_H"><img src="/images/hamburger.png"/></button><article class="contentWrapper_1Wy1l"><h1 class="title_29RlI">Decouple SDK Code From Core React Code</h1><div class="description_1Da_c">And reduce the size of your future PRs with the Open/Closed Principle</div><div class="date_2avFh"><time dateTime="2020-11-30">Nov 30, 2020</time></div><div class="content_33yU5"><h4>And reduce the size of your future PRs with the Open/Closed Principle</h4>
<p><img src="https://cdn-images-1.medium.com/max/1024/1*p37cH3mNXH_Z2wtXprcT2Q.jpeg" alt=""><figcaption>KNOW YOUR ENEMY<br /> (image by <a href="https://unsplash.com/photos/CatcixzdUcg">Klara Kulikova</a>, meme from <a href="https://programming-memes.com/spaghetti-code-know-your-enemy/">Programming Memes</a>)</figcaption></p>
<hr>
<p>Suppose I use an external service provider to process payments for my E-commerce app, and I need to embed some external SDK code to integrate the payment service into my app.</p>
<p>In this oversimplified example, let‚Äôs say the payment service is responsible for checking whether a given payment method (e.g, Apple Pay and Google Pay) is available based on the customer‚Äôs device, region, etc. While my ‚Äúcore‚Äù UI component <code>PaymentOptions</code> is responsible for rendering the available payment methods as options. Lastly, I want the flexibility of adding new payment methods in the future (for üìàüí∞reasons).</p>
<p>I can write it this way.</p>
<p>{% gist https://gist.github.com/suhanw/1cb50a75844ae43cc3ff9b24d8ffefb7 %}</p>
<p>However, the UI code is tightly coupled with the external code from the payment service, i.e., <strong>I have to modify the</strong>  <strong><code>PaymentOptions</code> component in order to add a new payment method or to make SDK updates.</strong></p>
<hr>
<p>I can perhaps break out the SDK code into a separate hook.</p>
<p>{% gist https://gist.github.com/suhanw/05b0dabbd467a37ec410c8efc6b6f94f %}</p>
<p><strong>However, I <em>still</em> have to modify</strong>  <strong><code>PaymentOptions</code></strong>  <strong>and any other components that share the</strong>  <strong><code>usePaymentMethods</code> hook if I wanted to add, for example,</strong>  <strong><code>isPaypalAvailable</code>.</strong></p>
<hr>
<p>To minimize the size of future PRs, I‚Äôve been thinking about the Open/Closed Principle, the ‚ÄúO‚Äù in SOLID (check out this excellent <a href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3">explainer</a>): ‚Äú<em>A software artifact should be open for extension but closed for modification.‚Äù</em></p>
<p>In my own words: <em>I should design this feature in such a way that I don‚Äôt have to touch any of the original code I wrote (closed for modification) if I were to add new payment methods in the future (open for extension).</em></p>
<p>Here‚Äôs my take on this principle. Let‚Äôs separate the payment service into its own module: a simple object where each key represents a payment method. Every payment method key points to an object with an <code>isAvailable</code> property (a function that uses the SDK code) and a <code>component</code> property (the UI component for the payment option).</p>
<p>{% gist https://gist.github.com/suhanw/7a3365d6e85f1d236fca12fcc4bba348 %}</p>
<p>Import <code>paymentServiceModule</code> into the <code>PaymentOptions</code> component.</p>
<p>{% gist https://gist.github.com/suhanw/b24d91ae215e6b4ba839a0f9bf9ba462 %}</p>
<p><code>PaymentOptions</code> is now decoupled from the SDK implementation details, and is ignorant of the particular payment methods.</p>
<p>When I want to extend this feature with a new payment method (i.e., PayPal), <strong>I simply slot in a new key/value pair to <code>paymentServiceModule</code> without having to modify either the <code>PaymentOptions</code> component or the original payment methods</strong>.</p>
<p>{% gist https://gist.github.com/suhanw/1b7d7ac0a6faf4838a169be094cba14a %}</p>
<p>The UI code should in theory also be protected against modification if I were to change payment service providers (for üí∏ reasons) as long as the payment method‚Äôs duck typing remains unchanged.</p>
<p>Am I applying the Open/Closed Principle correctly? Curious to learn other React or JavaScript patterns in the wild that follow this principle.</p>
<hr>
<h3>Bonus</h3>
<p>In <code>paymentServiceModule</code>, lazy load each payment option using the <a href="https://reactjs.org/docs/code-splitting.html#reactlazy"><code>React.lazy</code></a> API.</p>
<p>{% gist https://gist.github.com/suhanw/3b3055a9ad84e5bc1b12d423fc2bad6b %}</p>
<p>In <code>PaymentOptions</code>, wrap each payment option in <code>Suspense</code>, to lazy load the component based on availability.
{% gist https://gist.github.com/suhanw/3f68acc8c449c430a83109ede199a44f %}</p>
<hr>
<h3>Resources</h3>
<ul>
<li><a href="https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863">A First Step to Improve Your Code Before Diving into Domain Driven Design or the Clean Architecture</a> by <a href="https://medium.com/u/57de27e2974f">Andr√©as Hanss</a></li>
<li><a href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3">Revisiting SOLID</a> by <a href="https://medium.com/u/12cc371abade">Matthew Lucas</a></li>
</ul>
<hr>
<h3>Read More</h3>
<ul>
<li><a href="https://medium.com/javascript-in-plain-english/intro-to-react-server-side-rendering-3c2af3782d08">Intro to React Server Side Rendering</a></li>
<li><a href="https://dev.to/suhanw/decouple-data-from-ui-with-react-hooks-3amn">Decouple Data from UI with React Hooks</a></li>
<li><a href="https://medium.com/javascript-in-plain-english/how-to-decouple-data-from-ui-in-react-d6b1516f4f0b">Decouple Data from UI in React Part 2: A further exploration of the Hooks, Render Props, and HOC patterns</a></li>
</ul>
<hr>
<p>üì´ <em>Let‚Äôs connect on</em> <a href="https://www.linkedin.com/in/suhanwijaya/"><em>LinkedIn</em></a> <em>or</em> <a href="https://twitter.com/suhanw"><em>Twitter</em></a><em>!</em></p>
</div><div class="footer_2PjJq"></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"decouple-sdk-from-react","contentHtml":"\u003ch4\u003eAnd reduce the size of your future PRs with the Open/Closed Principle\u003c/h4\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn-images-1.medium.com/max/1024/1*p37cH3mNXH_Z2wtXprcT2Q.jpeg\" alt=\"\"\u003e\u003cfigcaption\u003eKNOW YOUR ENEMY\u003cbr /\u003e (image by \u003ca href=\"https://unsplash.com/photos/CatcixzdUcg\"\u003eKlara Kulikova\u003c/a\u003e, meme from \u003ca href=\"https://programming-memes.com/spaghetti-code-know-your-enemy/\"\u003eProgramming Memes\u003c/a\u003e)\u003c/figcaption\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eSuppose I use an external service provider to process payments for my E-commerce app, and I need to embed some external SDK code to integrate the payment service into my app.\u003c/p\u003e\n\u003cp\u003eIn this oversimplified example, let‚Äôs say the payment service is responsible for checking whether a given payment method (e.g, Apple Pay and Google Pay) is available based on the customer‚Äôs device, region, etc. While my ‚Äúcore‚Äù UI component \u003ccode\u003ePaymentOptions\u003c/code\u003e is responsible for rendering the available payment methods as options. Lastly, I want the flexibility of adding new payment methods in the future (for üìàüí∞reasons).\u003c/p\u003e\n\u003cp\u003eI can write it this way.\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/1cb50a75844ae43cc3ff9b24d8ffefb7 %}\u003c/p\u003e\n\u003cp\u003eHowever, the UI code is tightly coupled with the external code from the payment service, i.e., \u003cstrong\u003eI have to modify the\u003c/strong\u003e  \u003cstrong\u003e\u003ccode\u003ePaymentOptions\u003c/code\u003e component in order to add a new payment method or to make SDK updates.\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eI can perhaps break out the SDK code into a separate hook.\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/05b0dabbd467a37ec410c8efc6b6f94f %}\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eHowever, I \u003cem\u003estill\u003c/em\u003e have to modify\u003c/strong\u003e  \u003cstrong\u003e\u003ccode\u003ePaymentOptions\u003c/code\u003e\u003c/strong\u003e  \u003cstrong\u003eand any other components that share the\u003c/strong\u003e  \u003cstrong\u003e\u003ccode\u003eusePaymentMethods\u003c/code\u003e hook if I wanted to add, for example,\u003c/strong\u003e  \u003cstrong\u003e\u003ccode\u003eisPaypalAvailable\u003c/code\u003e.\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eTo minimize the size of future PRs, I‚Äôve been thinking about the Open/Closed Principle, the ‚ÄúO‚Äù in SOLID (check out this excellent \u003ca href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\"\u003eexplainer\u003c/a\u003e): ‚Äú\u003cem\u003eA software artifact should be open for extension but closed for modification.‚Äù\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eIn my own words: \u003cem\u003eI should design this feature in such a way that I don‚Äôt have to touch any of the original code I wrote (closed for modification) if I were to add new payment methods in the future (open for extension).\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eHere‚Äôs my take on this principle. Let‚Äôs separate the payment service into its own module: a simple object where each key represents a payment method. Every payment method key points to an object with an \u003ccode\u003eisAvailable\u003c/code\u003e property (a function that uses the SDK code) and a \u003ccode\u003ecomponent\u003c/code\u003e property (the UI component for the payment option).\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/7a3365d6e85f1d236fca12fcc4bba348 %}\u003c/p\u003e\n\u003cp\u003eImport \u003ccode\u003epaymentServiceModule\u003c/code\u003e into the \u003ccode\u003ePaymentOptions\u003c/code\u003e component.\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/b24d91ae215e6b4ba839a0f9bf9ba462 %}\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ePaymentOptions\u003c/code\u003e is now decoupled from the SDK implementation details, and is ignorant of the particular payment methods.\u003c/p\u003e\n\u003cp\u003eWhen I want to extend this feature with a new payment method (i.e., PayPal), \u003cstrong\u003eI simply slot in a new key/value pair to \u003ccode\u003epaymentServiceModule\u003c/code\u003e without having to modify either the \u003ccode\u003ePaymentOptions\u003c/code\u003e component or the original payment methods\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/1b7d7ac0a6faf4838a169be094cba14a %}\u003c/p\u003e\n\u003cp\u003eThe UI code should in theory also be protected against modification if I were to change payment service providers (for üí∏ reasons) as long as the payment method‚Äôs duck typing remains unchanged.\u003c/p\u003e\n\u003cp\u003eAm I applying the Open/Closed Principle correctly? Curious to learn other React or JavaScript patterns in the wild that follow this principle.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eBonus\u003c/h3\u003e\n\u003cp\u003eIn \u003ccode\u003epaymentServiceModule\u003c/code\u003e, lazy load each payment option using the \u003ca href=\"https://reactjs.org/docs/code-splitting.html#reactlazy\"\u003e\u003ccode\u003eReact.lazy\u003c/code\u003e\u003c/a\u003e API.\u003c/p\u003e\n\u003cp\u003e{% gist https://gist.github.com/suhanw/3b3055a9ad84e5bc1b12d423fc2bad6b %}\u003c/p\u003e\n\u003cp\u003eIn \u003ccode\u003ePaymentOptions\u003c/code\u003e, wrap each payment option in \u003ccode\u003eSuspense\u003c/code\u003e, to lazy load the component based on availability.\n{% gist https://gist.github.com/suhanw/3f68acc8c449c430a83109ede199a44f %}\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eResources\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863\"\u003eA First Step to Improve Your Code Before Diving into Domain Driven Design or the Clean Architecture\u003c/a\u003e by \u003ca href=\"https://medium.com/u/57de27e2974f\"\u003eAndr√©as Hanss\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/better-programming/revisiting-solid-927e6a5202d3\"\u003eRevisiting SOLID\u003c/a\u003e by \u003ca href=\"https://medium.com/u/12cc371abade\"\u003eMatthew Lucas\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003eRead More\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/javascript-in-plain-english/intro-to-react-server-side-rendering-3c2af3782d08\"\u003eIntro to React Server Side Rendering\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://dev.to/suhanw/decouple-data-from-ui-with-react-hooks-3amn\"\u003eDecouple Data from UI with React Hooks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/javascript-in-plain-english/how-to-decouple-data-from-ui-in-react-d6b1516f4f0b\"\u003eDecouple Data from UI in React Part 2: A further exploration of the Hooks, Render Props, and HOC patterns\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003eüì´ \u003cem\u003eLet‚Äôs connect on\u003c/em\u003e \u003ca href=\"https://www.linkedin.com/in/suhanwijaya/\"\u003e\u003cem\u003eLinkedIn\u003c/em\u003e\u003c/a\u003e \u003cem\u003eor\u003c/em\u003e \u003ca href=\"https://twitter.com/suhanw\"\u003e\u003cem\u003eTwitter\u003c/em\u003e\u003c/a\u003e\u003cem\u003e!\u003c/em\u003e\u003c/p\u003e\n","title":"Decouple SDK Code From Core React Code","description":"And reduce the size of your future PRs with the Open/Closed Principle","tags":"softwaredesign,react,webdev,javascript","canonical_url":"https://medium.com/javascript-in-plain-english/decouple-external-services-from-your-core-ui-code-dd490f91ae49","date":"2020-11-30"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"decouple-sdk-from-react"},"buildId":"G3ZcjjeYx68WiMTkAyruH","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-28a453ab78bd7ac4fdb9.js"></script><script src="/_next/static/chunks/main-08372472a9a690b518ed.js" async=""></script><script src="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/e4c8223e6318a62675b83f1688c61c375db5b2bb.d4f57090bd55662b89aa.js" async=""></script><script src="/_next/static/chunks/styles.718046618e39c9df9f0b.js" async=""></script><script src="/_next/static/chunks/pages/_app-3f426cc9284b0d3f87e0.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.4aea04fc80fc95b214df.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-1cc17da55ef19e625b6d.js" async=""></script><script src="/_next/static/G3ZcjjeYx68WiMTkAyruH/_buildManifest.js" async=""></script><script src="/_next/static/G3ZcjjeYx68WiMTkAyruH/_ssgManifest.js" async=""></script></body></html>