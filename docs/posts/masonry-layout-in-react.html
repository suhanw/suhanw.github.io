<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CZ0TSM98BL"></script><script>
									window.dataLayer = window.dataLayer || [];
									function gtag(){dataLayer.push(arguments)}
									gtag('js', new Date());
	
									gtag('config', 'G-CZ0TSM98BL');
							</script><meta charSet="utf-8"/><title>Masonry layout with React and CSS Flexbox by Suhan Wijaya</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="title" content="Masonry layout with React and CSS Flexbox by Suhan Wijaya"/><meta name="description" content="Using React, CSS Flexbox, and cats to create a masonry grid layout"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.suhanwijaya.com/posts/masonry-layout-in-react"/><meta property="og:title" content="Masonry layout with React and CSS Flexbox by Suhan Wijaya"/><meta property="og:description" content="Using React, CSS Flexbox, and cats to create a masonry grid layout"/><meta property="og:image" content="/images/masonry-layout-in-react_cover.jpg"/><meta name="twitter:title" content="Masonry layout with React and CSS Flexbox by Suhan Wijaya"/><meta name="twitter:description" content="Using React, CSS Flexbox, and cats to create a masonry grid layout"/><meta name="twitter:image" content="/images/masonry-layout-in-react_cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/styles.d9a27936.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.d9a27936.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-5e53dfd826fb0870df0c.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" as="script"/><link rel="preload" href="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.0aef9695673ee5c17c2c.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.dae767624ba255a10f93.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-bc363205d93151ffb13d.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.88486d05149e8c8d248a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-33b6975e9019f2512d4d.js" as="script"/></head><body><div id="__next"><div class="layout_GvkLX hasTopMenu_1WVP3"><nav class="menu_2G6rj topMenu_3pGJ_"><h2 class="name_10dbC">suhan <br/>wijaya</h2><ul class="menuItems_26ie3"><li class="menuItem_5m-L2"><a href="/#intro">INTRO</a></li><li class="menuItem_5m-L2"><a href="/#about">ABOUT</a></li><li class="menuItem_5m-L2"><a href="/#blog">BLOG</a></li><li class="menuItem_5m-L2"><a href="/#projects">PROJECTS</a></li><li class="menuItem_5m-L2"><a href="/#contact">CONTACT</a></li><li class="menuItem_5m-L2"><a href="/#toolbox">TOOLBOX</a></li></ul><a href="mailto:suhanw@gmail.com" target="_blank" class="email_3kN3h">suhanw@gmail.com</a><div class="social_3_hb2"><a href="https://www.linkedin.com/in/suhanwijaya/" target="_blank"><img src="/images/linked-in.png" alt="Suhan&#x27;s LinkedIn profile"/></a><a href="https://x.com/suhanw" target="_blank"><img src="/images/twitter-x.png" alt="Suhan&#x27;s Twitter profile"/></a><a href="https://github.com/suhanw" target="_blank"><img src="/images/github.png" alt="Suhan&#x27;s GitHub profile"/></a></div><ul class="topMenuItems_3Vx-y"><li class="menuItem_5m-L2"><a href="/#blog">BACK TO HOME</a></li></ul></nav><button class="hamburger_1KX_H"><img src="/images/hamburger.png"/></button><article class="contentWrapper_1Wy1l"><h1 class="title_29RlI">Masonry layout with React and CSS Flexbox</h1><div class="description_1Da_c">Using React, CSS Flexbox, and cats to create a masonry grid layout</div><div class="date_2avFh"><time dateTime="2023-06-27">Jun 27, 2023</time><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.suhanwijaya.com/posts/masonry-layout-in-react" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://twitter.com/intent/tweet?text=Masonry layout with React and CSS Flexbox by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/masonry-layout-in-react" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-share.png"/></a></span></div><div class="content_33yU5"><figure>
    <img src="/images/masonry-layout-in-react_cover.jpg">
</figure>
<hr>
<p>Masonry layout is a popular style of displaying images in a grid-like structure where elements of varying sizes and heights are arranged in a way that creates an uneven or "staggered" appearance. This layout style gets its name from the resemblance to the way bricks are arranged in a masonry wall.</p>
<p>Unlike traditional grid layouts where elements are aligned in neat rows and columns, masonry layout allows for more flexible and dynamic positioning. Each element, such as images or text blocks, is positioned based on available vertical space, filling gaps and creating an overall visually balanced design.</p>
<p>This layout style is particularly useful when rendering elements of different sizes or aspect ratios, as it can accommodate items with varying heights and widths without leaving excessive empty spaces.</p>
<hr>
<h3>Implementation</h3>
<figure>
    <img src="/images/masonry-layout-in-react_implementation.jpeg">
</figure>
<p>Yes, I know there are a ton of masonry layout libraries out there, but I decided to reinvent the wheel and build a simple version using plain old React, JavaScript, CSS… and cats.</p>
<p>Here’s the big picture:</p>
<ol>
<li>Suppose we have an array of cat images and want a grid layout with 4 columns.</li>
<li>Render the first 4 cat images in the array to “establish” the 4 columns.</li>
<li>Every subsequent cat image will then always be stacked on the column with the shortest height.</li>
</ol>
<hr>
<h3>Let’s start with CSS</h3>
<p>Use Flexbox to style the <code class="language-unknown">container</code> and <code class="language-unknown">column</code> elements. The <code class="language-unknown">container</code> parent vertically aligns the <code class="language-unknown">column</code> elements to the top and renders them in a row. Each <code class="language-unknown">column</code> element renders the <code class="language-unknown">tile</code> elements from top to bottom. All <code class="language-unknown">column</code> elements will occupy equal widths within the <code class="language-unknown">container</code> element.</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token selector"><span class="token class">.container</span></span> <span class="token punctuation">{</span>
	<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
	<span class="token property">align-items</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.column</span></span> <span class="token punctuation">{</span>
	<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
	<span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
	<span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Each <code class="language-unknown">tile</code> element contains the <code class="language-unknown">img</code> tag that renders a cat image of varying aspect ratios. The <code class="language-unknown">img</code> tag will expand to 100% width while the height will adjust based on the given image’s aspect ratio.</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token selector"><span class="token class">.tile</span></span> <span class="token punctuation">{</span>
	<span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token property">display</span><span class="token punctuation">:</span> inline-flex<span class="token punctuation">;</span>
	<span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.tile</span> img</span> <span class="token punctuation">{</span>
	<span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>What is the aspect ratio? In the context of images, the aspect ratio determines the shape and proportions of the image. It specifies how wide or tall an image appears relative to its size. By maintaining the aspect ratio, you ensure that the image retains its intended shape without distortion when it is displayed in different dimensions.</p>
<p>OK cool, let’s move on to JavaScript.</p>
<hr>
<h3>React, my old friend</h3>
<p>In this example, I’m using <a href="https://thecatapi.com/">the Cat API</a> to serve me a list of cat images. Let’s wrap the AJAX request in a <code class="language-unknown">useEffect</code> and store the data in the local state.</p>
<div class="remark-highlight"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span>cats<span class="token punctuation">,</span> setCats<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
	<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.thecatapi.com/v1/images/search?limit=10'</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCats</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The data for each individual cat object looks like this.</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
	id<span class="token operator">:</span> <span class="token string">"THXQ9Nqie"</span>
	url<span class="token operator">:</span> <span class="token string">"https://cdn2.thecatapi.com/images/THXQ9Nqie.jpg"</span>
	width<span class="token operator">:</span> <span class="token number">1080</span>
	height<span class="token operator">:</span> <span class="token number">940</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Now, let’s suppose we’re displaying the masonry layout in 4 columns. We need to know the width of the <code class="language-unknown">container</code> element on page load, which we will retrieve via <code class="language-unknown">containerRef</code> .</p>
<p>We’ll then take the array of cat images fetched from the API and organize them into the columns that will render the most visually balanced masonry grid, which we will store in the <code class="language-unknown">columns</code> state.</p>
<p>The <code class="language-unknown">columns</code> state is an array of 4 object literals corresponding to the 4 columns, each of which has the <code class="language-unknown">height</code> property that represents the total height of the column and a nested <code class="language-unknown">tiles</code> array that in turn contains the cat objects to be rendered in that given column.</p>
<div class="remark-highlight"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token constant">NUM_COLUMNS</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> containerRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>columns<span class="token punctuation">,</span> setColumns<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Lastly, this is the logic to execute the “big picture” steps laid out earlier. I commented on the key steps in the code below.</p>
<div class="remark-highlight"><pre class="language-jsx"><code class="language-jsx"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> columns <span class="token operator">=</span> <span class="token known-class-name class-name">Array</span><span class="token punctuation">.</span><span class="token keyword module">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> <span class="token constant">NUM_COLUMNS</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
		height<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
		tiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 1. iterate through each image</span>
	cats<span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cat<span class="token punctuation">,</span> catIndex</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
		<span class="token comment">// 2. iterate through each column and identify the shortest column</span>
		<span class="token keyword">let</span> shortestColumnIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&#x3C;</span> <span class="token constant">NUM_COLUMNS</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>columns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">?.</span>height <span class="token operator">&#x3C;</span> columns<span class="token punctuation">[</span>shortestColumnIndex<span class="token punctuation">]</span><span class="token operator">?.</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				shortestColumnIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 3. stack the current image under the current shortest column</span>
		columns<span class="token punctuation">[</span>shortestColumnIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">tiles</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			catIndex<span class="token punctuation">,</span>
			<span class="token spread operator">...</span>cat<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4. calculate current image's rendered height based on its aspect ratio</span>
		<span class="token keyword">const</span> columnWidth <span class="token operator">=</span> containerRef<span class="token operator">?.</span>current<span class="token operator">?.</span>clientWidth <span class="token operator">/</span> <span class="token constant">NUM_COLUMNS</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> tileHeight <span class="token operator">=</span> <span class="token punctuation">(</span>cat<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">/</span> cat<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">)</span> <span class="token operator">*</span> columnWidth<span class="token punctuation">;</span>

		<span class="token comment">// 5. update the height of the current column</span>
		columns<span class="token punctuation">[</span>shortestColumnIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">+=</span> tileHeight<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setColumns</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>cats<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p><strong>Steps 1 and 2.</strong> As we iterate through each image, find the shortest column at each iteration to which we will stack the current image. This can be done by keeping track of the current height of each column (with the <code class="language-unknown">height</code> property) and identifying the shortest one.</p>
<p><strong>Step 3.</strong> Once we’ve identified the shortest column, push the current image to the column’s <code class="language-unknown">tiles</code> array.</p>
<p><strong>Steps 4 and 5.</strong> Calculate the rendered height of the current image by using the <code class="language-unknown">container</code> element’s rendered width divided by the number of columns (in this case - <code class="language-unknown">4</code>) and the image's aspect ratio based on its actual height/width, and increment the column’s <code class="language-unknown">height</code> property to reflect the new total height of the current column.</p>
<hr>
<h3>Finally, the HTML markup</h3>
<p>The <code class="language-unknown">container</code> element is assigned the <code class="language-unknown">containerRef</code> variable, which gives us access to the element’s rendered width based on the user’s screen size. Then we simply iterate through each element in the <code class="language-unknown">columns</code> array, key into the <code class="language-unknown">tiles</code> property, and render the list of images in the appropriate columns as determined by the masonry layout logic above.</p>
<div class="remark-highlight"><pre class="language-javascript"><code class="language-javascript"><span class="token operator">&#x3C;</span>section className<span class="token operator">=</span><span class="token string">"container"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>containerRef<span class="token punctuation">}</span><span class="token operator">></span>
	<span class="token punctuation">{</span>columns<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">column<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
		<span class="token operator">&#x3C;</span>div className<span class="token operator">=</span><span class="token string">"column"</span> key<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token operator">></span>
			<span class="token punctuation">{</span>column<span class="token punctuation">.</span><span class="token property-access">tiles</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cat</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
				<span class="token operator">&#x3C;</span>div className<span class="token operator">=</span><span class="token string">"tile"</span> key<span class="token operator">=</span><span class="token punctuation">{</span>cat<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
					<span class="token operator">&#x3C;</span>span className<span class="token operator">=</span><span class="token string">"cat-index"</span><span class="token operator">></span><span class="token punctuation">{</span>cat<span class="token punctuation">.</span><span class="token property-access">catIndex</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span>
					<span class="token operator">&#x3C;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>cat<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
				<span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
			<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
		<span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
	<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span>section<span class="token operator">></span>
</code></pre></div>
<hr>
<h3>Tada!</h3>
<p>Here’s my <a href="https://codesandbox.io/s/masonry-layout-5grmlk?file=/src/App.js">CodeSandbox project</a> to see the whole thing come together.</p>
<figure>
    <img src="/images/masonry-layout-in-react-final.jpg">
</figure>
<p>The original indices from the array of cat images are displayed so you can visually see how the masonry logic determines which column a particular image belongs to.</p>
<p>Thanks for reading. In a future(ish 😅) article, I may explore adding bells and whistles such as making the React component more reusable, dynamically updating the number of columns based on screen widths, or implementing infinite scroll.</p>
</div><div class="footer_2PjJq"><span class="socialIcons_2XzlR"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.suhanwijaya.com/posts/masonry-layout-in-react" target="_blank" aria-label="Share this article on LinkedIn"><img src="/images/linkedin-share.png"/></a><a href="https://twitter.com/intent/tweet?text=Masonry layout with React and CSS Flexbox by Suhan Wijaya%20@suhanw%20https://www.suhanwijaya.com/posts/masonry-layout-in-react" target="_blank" aria-label="Share this article on Twitter"><img src="/images/twitter-share.png"/></a></span></div><div class="author_3TJVZ"><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya"><img src="https://github.com/suhanw.png?size=200"/></a><span>Liked what you&#x27;ve read? <br/><a href="https://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=suhanwijaya">Follow me on LinkedIn!</a></span></div></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"masonry-layout-in-react","contentHtml":"\u003cfigure\u003e\n    \u003cimg src=\"/images/masonry-layout-in-react_cover.jpg\"\u003e\n\u003c/figure\u003e\n\u003chr\u003e\n\u003cp\u003eMasonry layout is a popular style of displaying images in a grid-like structure where elements of varying sizes and heights are arranged in a way that creates an uneven or \"staggered\" appearance. This layout style gets its name from the resemblance to the way bricks are arranged in a masonry wall.\u003c/p\u003e\n\u003cp\u003eUnlike traditional grid layouts where elements are aligned in neat rows and columns, masonry layout allows for more flexible and dynamic positioning. Each element, such as images or text blocks, is positioned based on available vertical space, filling gaps and creating an overall visually balanced design.\u003c/p\u003e\n\u003cp\u003eThis layout style is particularly useful when rendering elements of different sizes or aspect ratios, as it can accommodate items with varying heights and widths without leaving excessive empty spaces.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eImplementation\u003c/h3\u003e\n\u003cfigure\u003e\n    \u003cimg src=\"/images/masonry-layout-in-react_implementation.jpeg\"\u003e\n\u003c/figure\u003e\n\u003cp\u003eYes, I know there are a ton of masonry layout libraries out there, but I decided to reinvent the wheel and build a simple version using plain old React, JavaScript, CSS… and cats.\u003c/p\u003e\n\u003cp\u003eHere’s the big picture:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eSuppose we have an array of cat images and want a grid layout with 4 columns.\u003c/li\u003e\n\u003cli\u003eRender the first 4 cat images in the array to “establish” the 4 columns.\u003c/li\u003e\n\u003cli\u003eEvery subsequent cat image will then always be stacked on the column with the shortest height.\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3\u003eLet’s start with CSS\u003c/h3\u003e\n\u003cp\u003eUse Flexbox to style the \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e and \u003ccode class=\"language-unknown\"\u003ecolumn\u003c/code\u003e elements. The \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e parent vertically aligns the \u003ccode class=\"language-unknown\"\u003ecolumn\u003c/code\u003e elements to the top and renders them in a row. Each \u003ccode class=\"language-unknown\"\u003ecolumn\u003c/code\u003e element renders the \u003ccode class=\"language-unknown\"\u003etile\u003c/code\u003e elements from top to bottom. All \u003ccode class=\"language-unknown\"\u003ecolumn\u003c/code\u003e elements will occupy equal widths within the \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e element.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.container\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e flex\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003ealign-items\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e flex-start\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.column\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e flex\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003eflex-direction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e column\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003eflex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEach \u003ccode class=\"language-unknown\"\u003etile\u003c/code\u003e element contains the \u003ccode class=\"language-unknown\"\u003eimg\u003c/code\u003e tag that renders a cat image of varying aspect ratios. The \u003ccode class=\"language-unknown\"\u003eimg\u003c/code\u003e tag will expand to 100% width while the height will adjust based on the given image’s aspect ratio.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.tile\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003emargin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e inline-flex\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003eposition\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e relative\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.tile\u003c/span\u003e img\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003emargin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token property\"\u003ewidth\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token unit\"\u003e%\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhat is the aspect ratio? In the context of images, the aspect ratio determines the shape and proportions of the image. It specifies how wide or tall an image appears relative to its size. By maintaining the aspect ratio, you ensure that the image retains its intended shape without distortion when it is displayed in different dimensions.\u003c/p\u003e\n\u003cp\u003eOK cool, let’s move on to JavaScript.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eReact, my old friend\u003c/h3\u003e\n\u003cp\u003eIn this example, I’m using \u003ca href=\"https://thecatapi.com/\"\u003ethe Cat API\u003c/a\u003e to serve me a list of cat images. Let’s wrap the AJAX request in a \u003ccode class=\"language-unknown\"\u003euseEffect\u003c/code\u003e and store the data in the local state.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-jsx\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecats\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e setCats\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euseState\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003euseEffect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003efetch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'https://api.thecatapi.com/v1/images/search?limit=10'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eres\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ejson\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003esetCats\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe data for each individual cat object looks like this.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"THXQ9Nqie\"\u003c/span\u003e\n\turl\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://cdn2.thecatapi.com/images/THXQ9Nqie.jpg\"\u003c/span\u003e\n\twidth\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1080\u003c/span\u003e\n\theight\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e940\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, let’s suppose we’re displaying the masonry layout in 4 columns. We need to know the width of the \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e element on page load, which we will retrieve via \u003ccode class=\"language-unknown\"\u003econtainerRef\u003c/code\u003e .\u003c/p\u003e\n\u003cp\u003eWe’ll then take the array of cat images fetched from the API and organize them into the columns that will render the most visually balanced masonry grid, which we will store in the \u003ccode class=\"language-unknown\"\u003ecolumns\u003c/code\u003e state.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode class=\"language-unknown\"\u003ecolumns\u003c/code\u003e state is an array of 4 object literals corresponding to the 4 columns, each of which has the \u003ccode class=\"language-unknown\"\u003eheight\u003c/code\u003e property that represents the total height of the column and a nested \u003ccode class=\"language-unknown\"\u003etiles\u003c/code\u003e array that in turn contains the cat objects to be rendered in that given column.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-jsx\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNUM_COLUMNS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e containerRef \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euseRef\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecolumns\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e setColumns\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euseState\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLastly, this is the logic to execute the “big picture” steps laid out earlier. I commented on the key steps in the code below.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-jsx\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"token function\"\u003euseEffect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e columns \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eArray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e length\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNUM_COLUMNS\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\theight\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\ttiles\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\t\u003cspan class=\"token comment\"\u003e// 1. iterate through each image\u003c/span\u003e\n\tcats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecat\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e catIndex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token comment\"\u003e// 2. iterate through each column and identify the shortest column\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e shortestColumnIndex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNUM_COLUMNS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumns\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e columns\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eshortestColumnIndex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003eheight\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\tshortestColumnIndex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e i\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\t\t\u003cspan class=\"token comment\"\u003e// 3. stack the current image under the current shortest column\u003c/span\u003e\n\t\tcolumns\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eshortestColumnIndex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etiles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\tcatIndex\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003ecat\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\t\t\u003cspan class=\"token comment\"\u003e// 4. calculate current image's rendered height based on its aspect ratio\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e columnWidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e containerRef\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003ecurrent\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003eclientWidth \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNUM_COLUMNS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e tileHeight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecat\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eheight\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e cat\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewidth\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e columnWidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\t\t\u003cspan class=\"token comment\"\u003e// 5. update the height of the current column\u003c/span\u003e\n\t\tcolumns\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eshortestColumnIndex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eheight\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e tileHeight\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\t\u003cspan class=\"token function\"\u003esetColumns\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumns\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elength\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eSteps 1 and 2.\u003c/strong\u003e As we iterate through each image, find the shortest column at each iteration to which we will stack the current image. This can be done by keeping track of the current height of each column (with the \u003ccode class=\"language-unknown\"\u003eheight\u003c/code\u003e property) and identifying the shortest one.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eStep 3.\u003c/strong\u003e Once we’ve identified the shortest column, push the current image to the column’s \u003ccode class=\"language-unknown\"\u003etiles\u003c/code\u003e array.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSteps 4 and 5.\u003c/strong\u003e Calculate the rendered height of the current image by using the \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e element’s rendered width divided by the number of columns (in this case - \u003ccode class=\"language-unknown\"\u003e4\u003c/code\u003e) and the image's aspect ratio based on its actual height/width, and increment the column’s \u003ccode class=\"language-unknown\"\u003eheight\u003c/code\u003e property to reflect the new total height of the current column.\u003c/p\u003e\n\u003chr\u003e\n\u003ch3\u003eFinally, the HTML markup\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode class=\"language-unknown\"\u003econtainer\u003c/code\u003e element is assigned the \u003ccode class=\"language-unknown\"\u003econtainerRef\u003c/code\u003e variable, which gives us access to the element’s rendered width based on the user’s screen size. Then we simply iterate through each element in the \u003ccode class=\"language-unknown\"\u003ecolumns\u003c/code\u003e array, key into the \u003ccode class=\"language-unknown\"\u003etiles\u003c/code\u003e property, and render the list of images in the appropriate columns as determined by the masonry layout logic above.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003esection className\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"container\"\u003c/span\u003e ref\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econtainerRef\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecolumns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecolumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003ediv className\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"column\"\u003c/span\u003e key\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\t\t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecolumn\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etiles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003ediv className\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"tile\"\u003c/span\u003e key\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecat\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\t\t\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003espan className\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"cat-index\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecat\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecatIndex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003espan\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\t\t\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eimg src\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecat\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eurl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ediv\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\t\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ediv\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003esection\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003chr\u003e\n\u003ch3\u003eTada!\u003c/h3\u003e\n\u003cp\u003eHere’s my \u003ca href=\"https://codesandbox.io/s/masonry-layout-5grmlk?file=/src/App.js\"\u003eCodeSandbox project\u003c/a\u003e to see the whole thing come together.\u003c/p\u003e\n\u003cfigure\u003e\n    \u003cimg src=\"/images/masonry-layout-in-react-final.jpg\"\u003e\n\u003c/figure\u003e\n\u003cp\u003eThe original indices from the array of cat images are displayed so you can visually see how the masonry logic determines which column a particular image belongs to.\u003c/p\u003e\n\u003cp\u003eThanks for reading. In a future(ish 😅) article, I may explore adding bells and whistles such as making the React component more reusable, dynamically updating the number of columns based on screen widths, or implementing infinite scroll.\u003c/p\u003e\n","pin_order":10,"title":"Masonry layout with React and CSS Flexbox","description":"Using React, CSS Flexbox, and cats to create a masonry grid layout","image":"/images/masonry-layout-in-react_cover.jpg","tags":"ui,javascript,webdev,masonry,css","date":"2023-06-27"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"masonry-layout-in-react"},"buildId":"PD2yRUYbFHkJLDdVptvEh","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-e3f124d20a714e6dd239.js"></script><script src="/_next/static/chunks/main-5e53dfd826fb0870df0c.js" async=""></script><script src="/_next/static/chunks/webpack-147ea3ada7109f6dc0bb.js" async=""></script><script src="/_next/static/chunks/framework.abffcf18e526b7c0dbcd.js" async=""></script><script src="/_next/static/chunks/c8817c810ac732b2202d2ab097cea034b8097b3b.0aef9695673ee5c17c2c.js" async=""></script><script src="/_next/static/chunks/styles.dae767624ba255a10f93.js" async=""></script><script src="/_next/static/chunks/pages/_app-bc363205d93151ffb13d.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.88486d05149e8c8d248a.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-33b6975e9019f2512d4d.js" async=""></script><script src="/_next/static/PD2yRUYbFHkJLDdVptvEh/_buildManifest.js" async=""></script><script src="/_next/static/PD2yRUYbFHkJLDdVptvEh/_ssgManifest.js" async=""></script></body></html>